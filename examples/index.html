---
layout: default
title: Examples
users:
- davelandry
- alexandersimoes
examples:
- title: "Tree Map"
  gists:
  - 9029130
  - 9860719
  - 9860411
  - 9860999
- title: "Scatter"
  gists:
  - 9029781
  - 9861345
- title: "Line Chart"
  gists:
  - 9037371
  - 9862486
- title: "Stacked Area Chart"
  gists:
  - 9029462
- title: "Network"
  gists:
  - 9042919
- title: "Rings"
  gists:
  - 9034389
- title: "Geo Map"
  gists:
  - 9042807
---

<section>
  <h2></h2>
</section>

<script src="/js/d3.js"></script>
<script src="http://d3js.org/queue.v1.min.js"></script>
<script src="/js/showdown.js"></script>

<script>

  var id = location.search.substr(1)

  function adjustIframeSize(newHeight) {
    var i = document.getElementById("gistFrame");
    i.style.height = parseInt(newHeight) + "px";
  }

  if (id) {

    d3.json("https://api.github.com/gists/"+id,function(error,gist){

      if (error || gist.length == 0) {

        d3.select("section h2").text("Error loading example.")

      }
      else {

        var section = d3.select("section")

        var title = gist.description || id

        document.title = title +" with D3plus"

        section.select("h2").text(title)

        var readme = gist.files["README.md"]
        if (readme) {

          var md = readme.content.replace(/\n\nFeatured on \[D3plus\.org\]\(http\:\/\/www\.d3plus\.org\/\)/g,"")
          md = md.replace(/\nFeatured on \[D3plus\.org\]\(http\:\/\/www\.d3plus\.org\/\)/g,"")
          md = md.replace(/Featured on \[D3plus\.org\]\(http\:\/\/www\.d3plus\.org\/\)/g,"")

          var converter = new Showdown.converter(),
              html = converter.makeHtml(md)

          section.append("p").attr("class","example").html(html)

        }

        var block = "http://bl.ocks.org/"+gist.user.login+"/raw/"+id+"/"+gist.history[0].version+"/"

        section.append("a")
          .attr("class","button right")
          .attr("href",block)
          .attr("target","_blank")
          .html("View Standalone <i class='fa fa-angle-right'></i>")

        section.append("iframe")
          .attr("class","example")
          .attr("width","960")
          .attr("height","640")
          .attr("src",block)

        var code = "https://gist.github.com/"+gist.user.login+"/"+id+".js?file=index.html"

        var gistFrame = section.append("iframe")
          .attr("id","gistFrame")
          .attr("class","example")
          .attr("width","960").node()

  			// Create the iframe's document
  			var gistFrameHTML = '<html><body onload="parent.adjustIframeSize(document.body.scrollHeight)"><scr' + 'ipt type="text/javascript" src="' + code + '"></sc'+'ript></body></html>';

  			// Set iframe's document with a trigger for this document to adjust the height
  			var gistFrameDoc = gistFrame.document;

  			if (gistFrame.contentDocument) {
  				gistFrameDoc = gistFrame.contentDocument;
  			} else if (gistFrame.contentWindow) {
  				gistFrameDoc = gistFrame.contentWindow.document;
  			}

  			gistFrameDoc.open();
  			gistFrameDoc.writeln(gistFrameHTML);
  			gistFrameDoc.close();

      }

    })

  }
  else {

    var q = queue()
    {% for user in page.users %}
      q.defer(d3.json,"https://api.github.com/users/{{user}}/gists?client_id={{site.github.id}}&client_secret={{site.github.secret}}")
    {% endfor %}
    q.awaitAll(function(error,data){

      if (error || data.length == 0) {

        d3.select("section h2").text("Error loading examples.")

      }
      else {

        var merged = []
        merged = merged.concat.apply(merged,data).filter(function(g){
          return g.public
        })

        var gists = {}
        merged.forEach(function(m){
          gists[m.id] = m
        })

        d3.select("section").remove()

        function enter(elem) {

          elem.style("opacity",0)
            .transition().duration(300)
            .style("opacity",1)

        }

        {% for app in page.examples %}

          var section = d3.select("#content").append("section")
          section.append("h2").text("{{ app.title }}")
            .call(enter)

          {% for gist in app.gists %}

            var gist = gists[{{gist}}]

            if (gist) {

              var title = gist.description || gist.id,
                  image = gist.files["thumbnail.png"]
                    ? gist.files["thumbnail.png"].raw_url
                    : "/assets/img/thumbnail.png"

              var button = section.append("a")
                .attr("class","example")
                .attr("href","?{{gist}}")
                .call(enter)

              button.append("img")
                .attr("src",image)
                .attr("alt","{{gist}}")

              button.append("div")
                .attr("class","title")
                .text(title)

              button.append("div")
                .attr("class","date")
                .text("Updated "+new Date(gist.updated_at).toLocaleDateString())

            }

          {% endfor %}

        {% endfor %}

      }
    })

  }

</script>
