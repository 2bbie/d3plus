---
layout: default
title: Examples
users:
- davelandry
---

<section>
  <h2></h2>
</section>

<script src="/js/d3.js"></script>
<script src="http://d3js.org/queue.v1.min.js"></script>
<script src="/js/showdown.js"></script>

<script>

  var order = ["tree_map","scatter","stacked","line","network","rings","geo_map"]

  var titles = {
    "tree_map": "Tree Map",
    "scatter": "Scatterplot",
    "stacked": "Stacked Area",
    "line": "Line Plot",
    "network": "Network",
    "rings": "Rings",
    "geo_map": "Geo Map"
  }

  var examples = {}
  {% for p in site.pages %}
    var url = "{{ p.url }}".split("/")
    if (url.length == 5 && url[1] == "examples" && url[3] != "simple") {
      var category = url[2], gist = url[3].split(".")[0]
      if (!examples[category]) examples[category] = []
      examples[category].push(gist)
    }
  {% endfor %}

  var q = queue()
  {% for user in page.users %}
    q.defer(d3.json,"https://api.github.com/users/{{user}}/gists?client_id={{site.github.id}}&client_secret={{site.github.secret}}")
  {% endfor %}
  q.awaitAll(function(error,data){

    if (error || data.length == 0) {

      d3.select("section h2").text("Error loading examples.")

    }
    else {

      var merged = []
      merged = merged.concat.apply(merged,data).filter(function(g){
        return g.public
      })

      var gists = {}
      merged.forEach(function(m){
        gists[m.id] = m
      })

      d3.select("section").remove()

      function enter(elem) {

        elem.style("opacity",0)
          .transition().duration(400).delay(delay)
          .style("opacity",1)

        delay += 30

      }

      var delay = 0
      order.forEach(function(type){

        var section = d3.select("#content").append("section")
        section.append("h2").text(titles[type])
          .call(enter)

        examples[type].forEach(function(g) {

          var gist = gists[g]

          if (gist) {

            var title = gist.description || gist.id,
                image = gist.files["thumbnail.png"]
                  ? gist.files["thumbnail.png"].raw_url
                  : "/assets/img/thumbnail.png"

            var button = section.append("a")
              .attr("class","example")
              .attr("href",type+"/"+g)
              .call(enter)

            button.append("img")
              .attr("src",image)
              .attr("alt",title)

            button.append("div")
              .attr("class","title")
              .text(title)

            button.append("div")
              .attr("class","date")
              .text("Updated "+new Date(gist.updated_at).toLocaleDateString())

          }

        })

      })

    }
  })

</script>
